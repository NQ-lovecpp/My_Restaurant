<view class="menu-page">
  <!-- 菜单列表 -->
  <view class="menu-list">
    <block wx:for="{{menuItems}}" wx:key="id">
      <view class="menu-item" bindtap="viewItemDetails" data-id="{{item.id}}">
        <image class="item-image" src="{{item.image_url}}" mode="aspectFill"></image>
        <view class="item-info">
          <view class="item-details">
            <text class="item-name">{{item.name}}</text>
            <text class="item-price">¥{{item.price}}</text>
          </view>
          <button bindtap="addToCart" data-id="{{item.menu_item_id}}" class="add-to-cart-button">加入购物车</button>
        </view>
      </view>
    </block>
  </view>

  <!-- 查看购物车按钮 -->
  <button bindtap="showCart" class="cart-button">cart</button>

  <!-- 菜品详情浮动窗口 -->
  <view class="item-detail-modal" wx:if="{{showItemDetail}}" bindtap="closeItemDetails">
    <view class="item-detail-content">
      <image class="item-detail-image" src="{{selectedItem.image_url}}" mode="aspectFill"></image>
      <view class="item-detail-info">
        <text class="item-detail-name">{{selectedItem.name}}</text>
        <br />
        <text class="item-detail-price">价格：¥{{selectedItem.price}}</text>
        <br />
        <text class="item-detail-description">{{selectedItem.description}}</text>
      </view>
    </view>
  </view>

  <!-- 购物车弹出窗口 -->
  <view class="cart" wx:if="{{cartVisible}}" animation="{{slideAnimation}}">
    <view class="cart-header">
      <text class="cart-title">购物车</text>
      <button bindtap="closeCart" class="close-button">关闭</button>
    </view>

    <!-- 购物车表头 -->
    <view class="cart-table-header">
      <text class="header-item">菜品名称</text>
      <text class="header-quantity">数量</text>
      <text class="header-price">总价</text>
    </view>

    <!-- 购物车商品列表 -->
    <view class="cart-items">
      <block wx:for="{{cartItems}}" wx:key="id">
        <view class="cart-item">
          <text class="item-name">{{item.name}}</text>
          <view class="quantity-controls">
            <button bindtap="decreaseQuantity" data-id="{{item.id}}" class="quantity-button">-</button>
            <text class="quantity">{{item.quantity}}</text>
            <button bindtap="increaseQuantity" data-id="{{item.id}}" class="quantity-button">+</button>
          </view>
          <text class="item-subtotal">¥{{item.subtotal}}</text>
        </view>
      </block>
    </view>

    <!-- 购物车底部总金额和提交按钮 -->
    <view class="cart-footer">
      <text class="total-label">总金额:</text>
      <text class="total-amount">¥{{totalAmount}}</text>
      <button bindtap="submitOrder" class="submit-button">提交订单</button>
    </view>
  </view>

</view>